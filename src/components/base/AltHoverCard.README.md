# AltHoverCard - Руководство по использованию

`AltHoverCard` - это компонент-обертка над `@ark-ui/vue/hover-card`, который предоставляет унифицированное API для создания тултипов и выпадающих карточек в приложении.

## Важные нюансы работы с HoverCard

1. **Необходимость видимого триггера**
   - HoverCard всегда требует реальный DOM-элемент в качестве триггера
   - Этот элемент должен иметь размеры (width/height > 0)
   - Триггер должен иметь `pointer-events: auto` для правильной обработки событий

2. **Позиционирование**
   - Ключевой параметр `:positioning` принимает объект с настройками позиционирования
   - Важные свойства:
     - `placement`: 'top' | 'bottom' | 'left' | 'right' - основное расположение
     - `gutter`: число в пикселях - отступ от триггера
     - `strategy`: 'fixed' | 'absolute' - стратегия позиционирования
     - `offset`: { mainAxis, crossAxis } - дополнительное смещение

3. **Анимация и задержки**
   - Используйте `:open-delay` и `:close-delay` для контроля задержек появления и исчезновения
   - Для красивых анимаций используйте CSS-переходы на элементе `.content-wrapper`
   - Синхронизируйте анимации стрелки с анимацией контента

4. **Телепортация**
   - Контент всегда телепортируется в body для избежания проблем с обрезкой
   - Используйте `z-index` для правильного порядка слоев

## Примеры использования

### Базовое использование

```vue
<AltHoverCard 
  :model-value="isVisible"
  :positioning="{ placement: 'bottom', gutter: 10 }"
  :show-arrow="true"
>
  <template #trigger>
    <div class="trigger-element">Наведите на меня</div>
  </template>
  <template #content>
    <div class="hover-content">
      Содержимое карточки при наведении
    </div>
  </template>
</AltHoverCard>
```

### Центрированный тултип (без целевого элемента)

```vue
<AltHoverCard 
  :model-value="isVisible"
  :positioning="{ 
    placement: 'bottom', 
    gutter: 20,
    offset: { mainAxis: 0, crossAxis: 0 }
  }"
  :show-arrow="false"
>
  <template #trigger>
    <div 
      style="position: fixed; top: 40%; left: 50%; width: 20px; height: 20px; 
      transform: translate(-50%, -50%); pointer-events: auto;"
    ></div>
  </template>
  <template #content>
    <div>Центрированное сообщение</div>
  </template>
</AltHoverCard>
```

### Синхронизация анимаций

Для синхронизации анимаций основного содержимого и стрелки:

```css
/* В стилях вашего компонента */
.tour-tooltip {
  transition: opacity 0.3s ease, transform 0.3s ease;
}

.arrow {
  transition: opacity 0.3s ease, transform 0.3s ease;
}
```

## Решение проблем

1. **Тултип не появляется**
   - Проверьте, что триггер имеет размеры и видим
   - Убедитесь, что триггер имеет `pointer-events: auto`
   - Проверьте, что значения `:open-delay` и `:close-delay` не конфликтуют

2. **Тултип позиционируется неправильно**
   - Для абсолютного позиционирования триггер и контент должны быть в одном контексте позиционирования
   - Для фиксированного позиционирования (`strategy: 'fixed'`) триггер также должен иметь `position: fixed`
   - Проверьте правильность расчета координат триггера

3. **Стрелка отображается неправильно**
   - Стрелка всегда должна указывать на центр триггера
   - Для маленьких триггеров используйте смещение `offset`
   - Для центрированных тултипов лучше скрывать стрелку (`show-arrow: false`)

## Советы для работы с особыми случаями

1. **Триггер без фиксированного положения**
   - Используйте ResizeObserver для обновления позиции при изменении размеров
   - Обновляйте позицию при скролле страницы

2. **Динамический контент**
   - Отслеживайте изменения размеров контента
   - Используйте ref для обращения к DOM-элементам контента

3. **Отладка позиционирования**
   - Временно сделайте триггер видимым с цветным фоном
   - Используйте инструменты разработчика для проверки размеров и позиций

## Внутренняя работа Ark UI HoverCard

HoverCard использует систему позиционирования Floating UI, которая рассчитывает оптимальное позиционирование с учетом:
- Границ экрана
- Размеров элементов
- Предпочтительного размещения
- Переполнения

Вычисление позиции происходит при:
- Инициализации
- Изменении размеров окна
- Скролле (если strategy: 'fixed')

Понимание этих принципов поможет эффективно использовать AltHoverCard в различных сценариях.
